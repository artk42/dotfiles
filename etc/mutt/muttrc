# TODO:
# - color scheme
# - more config https://neomutt.org/guide/configuration.html

set folder = ~/mail # mail location

#set abort_unmodified=yes	# automatically abort replies if I don't
				# change the message
set alias_file=~/.mail_aliases	# where I keep my aliases
#set allow_8bit			# never do Q-P encoding on legal 8-bit chars
set arrow_cursor		# use -> instead of hiliting the whole line
#set ascii_chars		# use ASCII instead of ACS chars for threads
#set askbcc
#set askcc
#set attribution="On %d, %n wrote:"	# how to attribute replies
set autoedit			# go to the editor right away when composing
#set auto_tag			# always operate on tagged messages
#set charset="iso-8859-1"	# character set for your terminal
set noconfirmappend		# don't ask me if i want to append to mailboxes
#set confirmcreate		# prompt when creating new files
set copy=yes			# always save a copy of outgoing messages
set delete=yes			# purge deleted messages without asking
set edit_headers		# let me edit the message header when composing
#set editor="emacs -nw"		# editor to use when composing messages
#set bounce=yes			# don't ask about bouncing messages, just do it
#set fast_reply			# skip initial prompts when replying
#set fcc_attach			# keep attachments in copies of sent messages?
#set force_name			# fcc by recipient, create if mailbox doesn't exist
#set forward_decode		# weed and MIME decode forwarded messages
#set forward_format="[%a: %s]"	# subject to use when forwarding messages
#set forward_quote		# quote the header and body of forward msgs
#set index_format="%4C %Z %{%m/%d} [%2N] %-15.15F (%4c) %s"
set index_format="%4C %Z %{%m/%d} %-15.15F (%4c) %s" # format of the index
#set hdrs			# include `my_hdr' lines in outgoing messages
#set header			# include message header when replying
set help			# show the help lines
#set history=20			# number of lines of history to remember
#set hostname="mutt.org"	# my DNS domain
set include			# always include messages when replying
#set indent_string="> "		# how to quote replied text
#set locale="C"			# locale to use for printing time
#set mailcap_path="~/.mailcap:/usr/local/share/mailcap"
set nomark_old			# i don't care about whether a message is old
set mail_check=10		# how often to poll for new mail
set mbox=+mbox			# where to store read messages
#set menu_scroll		# no implicit next-page/prev-page
#set metoo			# remove my address when replying
set mime_forward		# use message/rfc822 type to forward messages
set move=yes			# don't ask about moving messages, just do it
#set pager=less			# some people prefer an external pager
#set pager_context=3		# no. of lines of context to give when scrolling
#set pager_format="-%S- %-20.20f %s"	# format of the pager status bar
set pager_index_lines=6		# how many index lines to show in the pager
#set pager_stop			# don't move to the next message on next-page
#set pgp_strict_enc		# use Q-P encoding when needed for PGP
set postponed=+postponed	# mailbox to store postponed messages in
#set post_indent_string='---end quoted text---'
#set print=ask-yes		# ask me if I really want to print messages
set print_command=/bin/false	# how to print things (I like to save trees)
set noprompt_after	# ask me for a command after the external pager exits
#set quote_regex="^ *[a-zA-Z]*[>:#}]"	# how to catch quoted text
set read_inc=25			# show progress when reading a mailbox
#set recall			# prompt to recall postponed messages
set record=+outbox		# default location to save outgoing mail
set reply_to			# always use reply-to if present
#set reply_regex="^(re:[ \t]*)+"# how to identify replies in the subject:
#set resolve		# move to the next message when an action is performed
#set reverse_alias		# attempt to look up my names for people
set reverse_name		# use my address as it appears in the message
				# i am replying to
set nosave_empty		# remove files when no messages are left
#set save_name			# save outgoing messages by recipient, if the
#set sendmail="/usr/sbin/sendmail -oi -oem"	# how to deliver mail
#set shell="/bin/zsh"		# program to use for shell escapes
#set signature="~/.signature"	# file which contains my signature

# I subscribe to a lot of mailing lists, so this is _very_ useful.  This
# groups messages on the same subject to make it easier to follow a
# discussion.  NeoMutt will draw a nice tree showing how the discussion flows.
set sort=threads		# primary sorting method

#set sort_aux=reverse-date-received	# how to sort subthreads
#set sort_aux=last-date		# date of the last message in thread
set sort_browser=reverse-date	# how to sort files in the dir browser
set spoolfile='~/mailbox'	# where my new mail is located
#set status_format="-%r-NeoMutt: %f [Msgs:%?M?%M/?%m%?n? New:%n?%?d? Del:%d?%?F? Flag:%F?%?t? Tag:%t?%?p? Post:%p?%?b? Inc:%b?  %l]---(%s)-%>-(%P)---"
#set status_on_top		# some people prefer the status bar on top
#set strict_threads		# don't thread by subject
set tilde			# virtual lines to pad blank lines in the pager
#set timeout=0			# timeout for prompt in the index menu
#set tmpdir=~/tmp		# where to store temp files
#set to_chars=" +TCF"
#set use_8bitmime		# enable the -B8BITMIME sendmail flag
set nouse_domain		# don't qualify local addresses with $domain
#set use_from			# always generate the `From:' header field
set implicit_autoview=yes	# pager shows parts having a mailcap viewer
set crypt_verify_sig=no		# don't automatically verify message signatures
#set visual=vim			# editor invoked by ~v in the builtin editor
#set nowait_key			# prompt when a pipe returns normal status
set write_inc=25		# show progress while writing mailboxes

# only enable the following IFF you have sendmail 8.8.x or you will not
# be able to send mail!!!
#set dsn_notify='failure,delay'	# when to return an error message
#set dsn_return=hdrs		# what to return in the error message

# - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
#
# Header fields I don't normally want to see
#
ignore *		# this means "ignore all lines by default"

# I do want to see these fields, though!
unignore	from: subject to cc mail-followup-to \
		date x-mailer x-url # this shows how nicely wrap long lines

# - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
#
# Color definitions
#

#color normal white default
color hdrdefault red default
color quoted brightblue default
color signature red default
color indicator brightyellow red
color error brightred default
color status yellow blue
color tree magenta default	# the thread tree in the index menu
color tilde magenta default
color message brightcyan default
color markers brightcyan default
color attachment brightmagenta default
color search default green	# how to hilite search patterns in the pager
color warning brightyellow default

color header brightred default "^(From|Subject):"
color body magenta default "(ftp|http|https)://[^ ]+"	# point out URLs
color body magenta default "[-a-z_0-9.\+]+@[-a-z_0-9.]+"	# e-mail addresses
color underline brightgreen default

# attributes when using a mono terminal
#mono header underline ^(From|Subject):
mono quoted bold

# - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
#
# Key bindings
#
#	maps:
#		alias		alias menu
#		attach		attachment menu
#		browser		directory browser
#		compose		compose menu
#		index		message index
#		pgp		pgp menu
#		postpone	postponed message recall menu
#		generic		generic keymap for all of the above
#		editor		line editor
#		pager		text viewer
#

bind generic "\e<" first-entry	# emacs-like bindings for moving to top/bottom
bind generic \e> last-entry
bind generic { top-page
bind generic } bottom-page
bind generic \177 last-entry

macro index \cb "<pipe-message> urlview<Enter>"	# simulate the old browse-url function

macro index S "<save-message>+spam<Enter>"
macro pager S "<save-message>+spam<Enter>"

#macro index \#	"<search>bug<Enter>"	# search for bugs
#macro index "\""	"<enter-command> set realname=\"real hairy macro\" ?realname<Enter>" # and a comment to boot!
#macro index f1	"<enter-command>woohoo!"

bind pager G bottom	# just like vi and less
#macro   pager   \Ck     "<pipe-message> pgp -kaf<Enter>"   # a comment is valid here
#macro pager X "<pipe-message> morepgp<Enter>"	# pipe PGP message to a script

#bind editor \cy eol	# make ^Y jump to the end of the line

# - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
#
# User Defined Headers
#

#my_hdr X-Useless-Header: Look ma, it's a \# sign! # real comment
#my_hdr X-Operating-System: `uname -a`

# - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
#
# Specify default filename when saving messages
#
#	save-hook [!]<pattern> <mailbox>
#
# <mailbox> is provided as default when saving messages from <pattern>

#save-hook mutt- =mutt-mail
#save-hook aol\\.com$ +spam
save-hook ^judge +diplomacy

# - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
#
# Multiple spool mailboxes
#
#	mbox-hook [!]<pattern> <mbox-mailbox>
#
# Read mail in <pattern> is moved to <mbox-mailbox> when <pattern> is
# closed.

#mbox-hook =mutt-users.in =mutt-users
#mbox-hook +TEST +inbox

# - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
#
# Change settings based upon message recipient
#
#	send-hook [!]<pattern> <command>
#
# <command> is executed when sending mail to an address matching <pattern>

#send-hook mutt- 'set signature=~/.sigmutt; my_hdr From: Mutt User <user@example.com>'

# - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
#
# Specify where to save composed messages
#
#	fcc-hook [!]<pattern> <mailbox>
#
# <pattern> is recipient(s), <mailbox> is where to save a copy

#fcc-hook joe +joe
#fcc-hook bob +bob

# - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
#
# Change settings based on mailbox
#
#	folder-hook [!]<pattern> <command>
#
# <command> is executed when opening a mailbox matching <pattern>

#folder-hook .		'set sort=date-sent'
#folder-hook mutt	'set index_format="%4C %Z %02m/%02N %-20.20F (%4l) %s"'
#folder-hook =mutt	my_hdr Revolution: \#9 # real comment

#folder-hook .		'set reply_regex="^re:[ \t]*"'

# this mailing list prepends "[WM]" to all non reply subjects, so set
# $reply_regex to ignore it
# Warning: May break threads for other people.
#folder-hook +wmaker	'set reply_regex="^(re:[ \t]*)?\[WM\][ \t]*"'

# - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
#
# Aliases
#
#	alias <name> <address> [ , <address> ... ]

#alias exam "\# to annoy michael" <user@host>
#alias me Michael Elkins <me@mutt.org> # me!
alias mutt-dev Mutt Development List <mutt-dev@mutt.org> # power users
alias mutt-users Mutt User List <mutt-users@mutt.org>
alias mutt-announce Mutt Announcement List <mutt-announce@mutt.org>
alias wmaker WindowMaker Mailing List <wmaker@eosys.com>

# - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
#
# Specify the order of the headers to appear when displaying a message
#
#	hdr_order <hdr1> [ <hdr2> ... ]
#

unhdr_order *				# forget the previous settings
hdr_order date from subject to cc

# - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
#
# Identify mailing lists I subscribe to
#
#	lists <list-name> [ <list-name> ... ]

lists ^mutt-dev@mutt\\.org$ ^mutt-users@mutt\\.org$

# - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
#
# Automatically use entries from ~/.mailcap to view these MIME types
#
#	auto_view <type> [ <type> ... ]

auto_view application/x-gunzip
auto_view application/x-gzip

# - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
#
# Scoring
#
#	score <pattern> <value>
#
# 9999 and -9999 are special values which cause processing of hooks to stop
# at that entry.  If you prefix the score with an equal sign (=), the score
# is assigned to the message and processing stops.

#score '~f ^me@cs\.hmc\.edu$' 1000
#score '~t mutt | ~c mutt' =500
#------------------------------------------------------------
# Vi Key Bindings
#------------------------------------------------------------

# Moving around
bind attach,browser,index       g   noop
bind attach,browser,index       gg  first-entry
bind attach,browser,index       G   last-entry
bind pager                      g  noop
bind pager                      gg  top
bind pager                      G   bottom
bind pager                      k   previous-line
bind pager                      j   next-line

# Scrolling
bind attach,browser,pager,index \CF next-page
bind attach,browser,pager,index \CB previous-page
bind attach,browser,pager,index \Cu half-up
bind attach,browser,pager,index \Cd half-down
bind browser,pager              \Ce next-line
bind browser,pager              \Cy previous-line
bind index                      \Ce next-line
bind index                      \Cy previous-line

bind pager,index                d   noop
bind pager,index                dd  delete-message

# Mail & Reply
bind index                      \Cm list-reply # Doesn't work currently

# Threads
bind browser,pager,index        N   search-opposite
bind pager,index                dT  delete-thread
bind pager,index                dt  delete-subthread
bind pager,index                gt  next-thread
bind pager,index                gT  previous-thread
bind index                      za  collapse-thread
bind index                      zA  collapse-all # Missing :folddisable/foldenablescore '~f aol\.com$' -9999

#
# Starter neomuttrc file, with just a few suggestions and settings.
#
# This file purposely doesn't include hooks, keybinding, macros, colors, etc.
# Read the manual, explore, and have fun!
#

###############
# Identity
#
set realname = "Example User"
set from = "user@example.com"

# If you have another address:
alternates "^neomutt@example\.com$"

# Or, if you use the entire domain:
alternates "@example\.com$"
set reverse_name

###############
# Example: local mailboxes
#
# Some people use mbsync or getmail to retrieve their mail locally.
#
set folder = ~/Mail           # This has the shortcut '+' or '='
set spoolfile = "+inbox"      # This has the shortcut '!'
set record = "+sent"
set trash = "+trash"
set postponed = "+drafts"

mailboxes ! +neomutt +family +work

###############
# Example: Gmail over IMAP
#
set imap_user = ".....@gmail.com"

# To avoid storing your password in the .neomuttrc:
# echo -n 'mypassword' | gpg --encrypt -r 0x1234567890ABCDEF > ~/.neomutt/account.gpg
set imap_pass = "`gpg --batch -q --decrypt ~/.neomutt/account.gpg`"

set folder = imaps://imap.gmail.com/
set spoolfile = "+INBOX"
unset record                # Gmail auto-stores in "+[Gmail].Sent Mail"
unset trash                 # Unset, deletion will remove labels
set postponed = "+[Gmail].Drafts"

set mail_check = 60

###############
# Pager settings
#
ignore *
unignore From Message-ID Date To Cc Bcc Subject

set pager_stop
unset markers

# Prefer plain text to html.
# However, for brain dead clients that bundle attachments inside a
# multipart/alternative, prefer that alternative.
alternative_order multipart/mixed multipart/related text/plain

# Consult mime.types for determining types of these attachments
mime_lookup application/octet-stream

# This requires a ~/.mailcap entry with the copiousoutput flag, such as:
# text/html; lynx -dump -width ${COLUMNS:-80} %s; nametemplate=%s.html; copiousoutput
auto_view text/html

###############
# Index settings
#
set quit = ask-yes
set sort = threads

# Remember to `mkdir -p ~/.neomutt/hcache` first:
set header_cache= "~/.neomutt/hcache"

###############
# Message composition settings
#
set edit_headers

# set editor = "emacsclient -a emacs -t"
# set editor = "vim"

set mime_type_query_command = "xdg-mime query filetype"

# msmtp is a solid SMTP client.
# neomutt also has built-in SMTP, or you can use an MTA like exim4 or postfix.
set sendmail = "/usr/bin/msmtp"

# lbdb is a versatile contact query tool.
# Invoke via ctrl-t in an address prompt
set query_command = "/usr/bin/lbdbq"

###############
# GnuPG
#
unset crypt_use_gpgme
source /usr/local/share/doc/neomutt/samples/gpg.rc
set pgp_default_key = "0x1234567890ABCDEF"
set crypt_opportunistic_encrypt
set postpone_encrypt
# -*-muttrc-*-

#
# Mutt configuration file of Thomas Roessler <roessler@does-not-exist.org>
#
# Use and distribute freely.
#
# Note: This file doesn't contain any personal customization, i.e.,
# using it won't make you send messages with my name in the header.
#
# Things to change: You probably want to change the "priv.rc" source
# command in the end of this file.  Also, it's likely you want to have
# a look at the the $editor and $tmpdir variables.
#

#
# MIME settings
#

# auto_view application/ms-tnef text/x-vcard
# auto_view application/x-chess application/x-lotus-notes
# auto_view text/html application/x-gzip application/x-gunzip
# auto_view application/rtf application/x-rath
# auto_view application/msword

auto_view text/html
mime_lookup application/octet-stream

# alternative_order application/pgp text/html text/enriched text/plain
alternative_order text/plain text/html


#
# Key bindings
#

#
# A few of these may resemble Pine.  ups.
#

bind    alias   " "             tag-entry
bind    alias   \n              select-entry
bind    alias   \r              select-entry

bind    attach  i               exit
bind    attach  n               next-entry
bind    attach  p               previous-entry
bind    attach  " "             select-entry
bind    attach  y               print-entry

bind    browser <end>           last-entry
bind    browser <home>          first-entry

bind    editor  "\e<backspace>" kill-word
bind    editor  "\e<delete>"    kill-word
bind    editor  "<backtab>"     complete-query
bind    editor  "\eq"           complete-query
bind    editor  "\Ct"           transpose-chars

bind    generic "\CV"           next-page
bind    generic "\Ca"           first-entry
bind    generic "\Ce"           last-entry
bind    generic "\eV"           previous-page
bind    generic "\ev"           previous-page
bind    generic +               tag-entry
bind    generic ^               first-entry
bind    generic a               tag-prefix
bind    generic $               last-entry
bind    generic q               exit

bind    index   ";"             limit
bind    index   "\Ce"           last-entry      # override edit-type
bind    index   "\eV"           previous-page   # override collapse-something
bind    index   "\e<"           collapse-thread
bind    index   "\eq"           query
bind    index   $               last-entry
bind    index   *               flag-message
bind    index   <delete>        delete-message
bind    index   <end>           last-entry
bind    index   <home>          first-entry
bind    index   J               next-entry
bind    index   K               previous-entry
bind    index   Q               quit
bind    index   R               group-reply
bind    index   \em             recall-message
bind    index   a               tag-prefix
bind    index   m               mail
bind    index   p               previous-entry
bind    index   t               create-alias
bind    index   x               sync-mailbox
bind    index   y               print-message
bind    index   n               next-entry
bind    index   "\ev"           previous-page

bind    pager   "\Cn"           next-line
bind    pager   "\Cp"           previous-line
bind    pager   +               tag-message
bind    pager   *               flag-message
bind    pager   <delete>        delete-message
bind    pager   <down>          next-line
bind    pager   <end>           bottom
bind    pager   <home>          top
bind    pager   <up>            previous-line
bind    pager   G               group-reply
bind    pager   R               group-reply
bind    pager   \em             recall-message
bind    pager   t               display-toggle-weed # like slrn
bind    pager   y               print-message

bind    query   i               exit

# make it feel like emacs

macro   generic "\ex"           ":exec "
macro   pager   "\ex"           ":exec "
macro   generic "\eX"           "\ex"
macro   pager   "\eX"           "\ex"

macro   index   "~"             ";~"
# macro index   "%"             ";%"

# Thread tagging

bind   index    "\et"           tag-subthread
bind   index   "\eT"            tag-thread

# for majordomo list owner and moderator jobs

macro   index   "\ea"           ":set nopipe_decode wait_key\n|approve\n:set nowait_key\n"
macro   pager   "\ea"           ":set nopipe_decode wait_key\n|approve\n:set nowait_key\n"

# emulate the old URL-browser key bindings.

macro   pager   "\Cb"   "| urlview -\n"
macro   index   "\Cb"   "| urlview -\n"

# permit limiting from the pager.

macro   pager   "~"     "<exit><limit>~"
macro   pager   ";"     "<exit><limit>"

# emulate the old POP-feature bindings

macro   index   G       "!fetchmail\n"
macro   pager   G       "!fetchmail\n"

# razor-report: Report spam.

# macro index   S       ":set nopipe_decode nowait_key\n|razor-report > /dev/null 2> /dev/null\ns+junk\n"
# macro   pager S       ":set nopipe_decode nowait_key\n|razor-report > /dev/null 2> /dev/null\ns+junk\n"
macro   index   S       "s+junk\n"
macro   pager   S       "s+junk\n"

#
# Colors
#

# This is a tiny hack, so I can get different
# color schemes on the console and under X11.

source ~/.mutt/colors.`if [ "$TERM" = "linux" ] ; then echo linux ; else echo default ; fi`

mono  index bold ~F
# mono  body  bold '\*[^*]+\*'
# mono  body  underline '_[^_]+_'

#
# The header weed list
#

ignore delivered-to
ignore content- errors-to in-reply-to mime-version
ignore lines precedence status
ignore nntp-posting-host path old-return-path received references
ignore priority >received >>received
ignore resent- return-path xref path
ignore x400 importance sensitivity autoforward original-encoded-information
ignore x- thread-
ignore DomainKey-Signature mail-followup-to

ignore list- comments posted-to approved-by

unignore x-spam-level x-url x-mailer list-id x-no-spam x-archived-at
unignore x-diagnostic

hdr_order from to cc date subject reply-to mail-followup-to list-id

#
# Various settings
#

set   abort_nosubject=no                # Let me send messages with an empty subject
set   abort_unmodified=no               # Let me send empty messages
set   alias_file=~/.mutt/aliases        # Where to store aliases
unset allow_8bit                        # Produce correct MIME
unset arrow_cursor                      # Use the bar cursor
set   askcc                             # Ask me about CCs
unset bounce_delivered                  # Don't include Delivered-to with bounces
# set   charset=iso-8859-1              # The local character set
set   send_charset="us-ascii:iso-8859-1:iso-8859-15:iso-8859-2:utf-8"
set   confirmcreate                     # Ask me about creating new files
unset confirmappend                     # Don't ask me about appending to files
set   delete=yes                        # Don't ask me whether or not I meant to delete messages
# set   display_filter="tr '\240\204\223\226' ' \"\"-'" # fix some funny characters
set   edit_headers                      # I want to edit the headers.
set   editor="/usr/bin/jed %s -f 'mail_mode();'"
                                        # Invoke jed with mail_mode.  This may
                                        # or may not work for you.
set   noenvelope_from                   # set messages' envelope-from header.
set   fcc_clear                         # Store local copies of messages in the clear.
set   folder=~/Mail                     # Where my mail folders go
set   followup_to                       # Create Mail-Followup-To headers.
unset force_name                        # Don't create save folders which don't exist.
set   forward_decode                    # Decode messages when forwarding.
set   forward_decrypt                   # Decrypt messages when forwarding.
set   nohelp                            # No help line.
set   include=yes                       # Always include a copy when replying.
set   mark_old                  # Distinguish between seen (but unread) and new messages
set   mbox=+mbox                        # The (unused) mbox file.
unset metoo                             # Remove me from CC headers.
set   mime_forward_rest=ask-no          # Ask me whether or not to create a MIME-encapsulated forward
set   move=no                           # Don't use mbox
set   pager_stop                        # Don't fall through to the next message in the pager
set   pager_index_lines=0               # The pager index is ugly.
set   crypt_replyencrypt                # Encrypt when replying to encrypted messages.
set   crypt_replysignencrypted          # Sign when replying to encrypted messages.
set   pgp_show_unusable="no"            # Don't display unusable keys.
set   pgp_sort_keys="keyid"             # Sort keys by key ID
set   crypt_replysign                   # Sign when replying to signed messages.
set   pgp_timeout=3600                  # Forget the PGP passphrase after an hour.
set   pipe_decode                       # Decode messages I pipe to commands, typically to patch(1).
set   postponed=~/.mutt/postponed       # Where to put postponed messages
set   print=ask-no                      # Don't waste paper
set   print_command="enscript -2Gr -Email"      # Two columns, landscape, fancy header.
set   print_split=yes                   # Invoke enscript once per message
set   quit=yes                          # Don't ask me whether or not I want to quit.
set   quote_regex="^ *[a-zA-Z]*[>|][>:|]*"     # Recognize quotes in the pager.
set   read_inc=50                       # Progress indicator when reading folders.
set   recall=ask-no                     # When I say "compose", ask me whether I want to continue
                                        # composing a postponed message.
set   record="+archive/now"             # Put copies of most outgoing messages to ~/Mail/archive/now
set   reply_to=ask-yes                  # Ask me whether I want to honor users' reply-to headers.
set   reverse_alias                     # Use aliases to display real names on the index.
set   save_name                         # Save copies by name.  Together with $record and $save_name,
                                        # this means that when a folder exists, copies of outgoing
                                        # messages are written to ~/Mail/<name>, otherwise they go to
                                        # ~/Mail/archive/now
set   signature=~/.signature            # Silly signature
set   sig_dashes                        # Add dashes above my signature
set   smart_wrap                        # Try to be smart when wrapping around lines in the pager
set   sort=threads                      # sort by threads,
set   sort_aux=date                     # then by date
unset strict_threads                    # don't be strict about threads
# set   suspend=no                      # Don't suspend - I usually run mutt like this: "xterm -e mutt"
set   tilde                             # Indicate empty lines in the pager.
set   tmpdir=~/.tmp                     # Temporary files aren't stored in public places.
set   to_chars=" +TCF "                 # Don't tag list mail in the index

unset use_domain                        # Don't append a domain to addresses.

set   write_inc=50                      # Progress indicator when writing folders.
set   query_command="lbdb2q.pl %s"              # Use the Little Brother's Database with the external
                                        # query feature.
set   sendmail_wait=-1                  # Don't put sendmail into the background.
set   encode_from                       # "From " in the beginning of a line triggers quoted-printable
set   nowait_key                        # Return immediately from external programs
set   forward_format="[fwd] %s (from: %a)"      # A different subject for forwarded messages
set   nobeep                            # Shut up. ;-)
set   reply_regex="^((re([\\[0-9\\]+])*|aw):[ \t]*)+[ \t]*"    # A regular expression to detect replies
set   header                            # Include the message header when replying.
set   ignore_list_reply_to              # Ignore Reply-To headers pointing to mailing lists.
set   norfc2047_parameters              # Sometimes, I get mails which use a bogus encoding for
                                        # MIME parameters.  Setting this shouldn't harm.
                                        # (OK, she doesn't use Notes any more, so I can unset this. ;-)
# set   text_flowed                     # Generate text/plain; format=flowed
# unset use_ipv6                                # Don't try to use IPv6 - it doesn't work here.
set   keep_flagged                      # don't move flagged messages to mbox
set   hide_missing=yes                  # Don't show how many messages are missing in a thread structure

set status_format="-%r-+(%v) %f [Msgs:%?M?%M/?%m%?n? New:%n?%?o? Old:%o?%?d? Del:%d?%?F? Flag:%F?%?t? Tag:%t?%?p? Post:%p?%?b? Inc:%b?%?l? %l?]----%>-(%P)---"
set compose_format="--+(%v) Compose  [Approx. msg size: %l   Atts: %a]%>-"
set pager_format="-%Z- %C/%m: %.20n %> %s"

set smileys="^$"
set ispell=iaspell

set markers=no                          # Don't mark wrapped lines
set wrap=-4                             # Leave a margin in the pager

# PGP command configuration
# source ~/.mutt/pgp2.rc
source ~/.mutt/gpg.rc
set pgp_getkeys_command=""

# source ~/.mutt/smime.rc


# source non-public stuff, (hooks, alternates, ...)
source ~/.mutt/priv.rc

# source aliases
# source ~/.mutt/aliases-coruscant
source ~/.mutt/aliases
# -*-muttrc-*-
## The following options are only available if you have
## compiled in S/MIME support

# If you compiled neomutt with support for both PGP and S/MIME, PGP
# will be the default method unless the following option is set
set smime_is_default

# Uncomment this if you don't want to set labels for certificates you add.
# unset smime_ask_cert_label

# Passphrase expiration
set smime_timeout=300

# Global crypto options -- these affect PGP operations as well.
set crypt_autosign = yes
set crypt_replyencrypt = yes
set crypt_replysign = yes
set crypt_replysignencrypted = yes
set crypt_verify_sig = yes


# Section A: Key Management

# The default keyfile for encryption (used by $smime_self_encrypt and
# $postpone_encrypt).
#
# It will also be used for decryption unless
# $smime_decrypt_use_default_key is unset.
#
# It will additionally be used for signing unless $smime_sign_as is
# set to a key.
#
# Unless your key does not have encryption capability, uncomment this
# line and replace the keyid with your own.
#
# set smime_default_key="12345678.0"

# If you have a separate signing key, or your key _only_ has signing
# capability, uncomment this line and replace the keyid with your
# signing keyid.
#
# set smime_sign_as="87654321.0"

# Uncomment to make neomutt ask what key to use when trying to decrypt a message.
# It will use the default key above (if that was set) else.
# unset smime_decrypt_use_default_key

# Path to a file or directory with trusted certificates
set smime_ca_location="~/.smime/ca-bundle.crt"

# Path to where all known certificates go. (must exist!)
set smime_certificates="~/.smime/certificates"

# Path to where all private keys go. (must exist!)
set smime_keys="~/.smime/keys"

# These are used to extract a certificate from a message.
# First generate a PKCS#7 structure from the message.
set smime_pk7out_command="openssl smime -verify -in %f -noverify -pk7out"

# Extract the included certificate(s) from a PKCS#7 structure.
set smime_get_cert_command="openssl pkcs7 -print_certs -in %f"

# Extract the signer's certificate only from a S/MIME signature (sender verification)
set smime_get_signer_cert_command="openssl smime -verify -in %f -noverify -signer %c -out /dev/null"

# This is used to get the email address the certificate was issued to.
set smime_get_cert_email_command="openssl x509 -in %f -noout -email"

# Add a certificate to the database using smime_keys.
set smime_import_cert_command="/usr/libexec/neomutt/smime_keys add_cert %f"



# Section B: Outgoing messages

# Algorithm to use for encryption.
# valid choices are aes128, aes192, aes256, rc2-40, rc2-64, rc2-128, des, des3
set smime_encrypt_with="aes256"

# Encrypt a message.  Input file is a MIME entity.
set smime_encrypt_command="openssl smime -encrypt -%a -outform DER -in %f %c"

# Algorithm for the signature message digest.
# Valid choices are md5, sha1, sha224, sha256, sha384, sha512.
set smime_sign_digest_alg="sha256"

# Sign.
set smime_sign_command="openssl smime -sign -md %d -signer %c -inkey %k -passin stdin -in %f -certfile %i -outform DER"



# Section C: Incoming messages

# Decrypt a message.  Output is a MIME entity.
set smime_decrypt_command="openssl smime -decrypt -passin stdin -inform DER -in %f -inkey %k -recip %c"

# Verify a signature of type multipart/signed
set smime_verify_command="openssl smime -verify -inform DER -in %s %C -content %f"

# Verify a signature of type application/x-pkcs7-mime
set smime_verify_opaque_command="\
openssl smime -verify -inform DER -in %s %C || \
openssl smime -verify -inform DER -in %s -noverify 2>/dev/null"



# Section D: Alternatives

# Sign.  If you wish to NOT include the certificate your CA used in signing
# your public key, use this command instead.
# set smime_sign_command="openssl smime -sign -md %d -signer %c -inkey %k -passin stdin -in %f -outform DER"
#
# In order to verify the signature only and skip checking the certificate chain:
#
# set smime_verify_command="openssl smime -verify -inform DER -in %s -content %f -noverify"
# set smime_verify_opaque_command="openssl smime -verify -inform DER -in %s -noverify"
#
